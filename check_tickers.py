"""
This code is a mess and is purely for testing purposes. Some of it was written while I was drunk.
If you run the commented out code, it WILL take 8 hours to validate all the tickers. Don't do it.
"""

import yfinance as yf
import urllib.request as request
import shutil
from contextlib import closing
from refresh_tickers import get_tickers


from datetime import datetime

fetch_start = datetime.now()

base_url = 'ftp://ftp.nasdaqtrader.com/SymbolDirectory/'
nasdaq_url = 'nasdaqlisted.txt'
other_url = 'otherlisted.txt'

nasdaq = get_tickers(nasdaq_url)
other = get_tickers(other_url)


# ========================================
#count = 0
#length = len(other)
#other_invalid = []

#for ticker in other:
   #count = count + 1

    #print(str(count) + '/' + str(length))
    #try:
       # tick = yf.Ticker(ticker)
       # tick.info
   # except:
      #  other_invalid.append(ticker)


# ====================================================

# TODO: optimize code to validate downloaded tickers against yahooo finance tickers

# invalid tickers as of October 18th 2020
nasdaq_invalid = ['AACQU', 'AACQW', 'AAON', 'ABCB', 'ABIO', 'ACAMW', 'ACEV', 'ACEVW', 'ACGL', 'ACHV', 'ACLS', 'ACST', 'ACTCU', 'ADES', 'ADILW', 'ADMP', 'ADXS', 'AEHL', 'AEMD', 'AEPPL', 'AEY', 'AEYE', 'AEZS', 'AGBA', 'AGBAR', 'AGBAW', 'AGCUU', 'AGEN', 'AHACU', 'AHPI', 'AINV', 'AIRTP', 'AIRTW', 'AKER', 'AKU', 'ALACR', 'ALGN', 'ALGS', 'ALIM', 'ALLT', 'ALT', 'ALTM', 'AMCIW', 'AMHCW', 'AMRH', 'AMRHW', 'AMRN', 'AMRS', 'AMSC', 'AMST', 'AMTX', 'AMYT', 'ANDAR', 'ANDAW', 'ANTE', 'ANY', 'APDN', 'APEX', 'APOP', 'APOPW', 'APTO', 'APVO', 'APXTW', 'APYX', 'AREC', 'ARNA', 'ARRY', 'ARTL', 'ARTLW', 'ARWR', 'ARYA', 'ARYBW', 'ASML', 'ASO', 'ASPU', 'ASRVP', 'ASTC', 'ASYS', 'ATCXW', 'ATEC', 'ATHA', 'ATIF', 'ATOS', 'ATRI', 'ATSG', 'ATXI', 'AUTO', 'AUVI', 'AVCTW', 'AVEO', 'AVGR', 'AVNW', 'AVO', 'AVXL', 'AXDX', 'AXGT', 'AY', 'AYTU', 'AZYO', 'BANFP', 'BANR', 'BCDA', 'BCDAW', 'BCLI', 'BCML', 'BCTG', 'BEEMW', 'BFRA', 'BHFAL', 'BIOC', 'BIOL', 'BIVI', 'BKSC', 'BKYI', 'BLCM', 'BLCT', 'BLFS', 'BLIN', 'BLNKW', 'BLPH', 'BLRX', 'BLU', 'BMRA', 'BNGOW', 'BNSO', 'BOKFL', 'BOSC', 'BOTJ', 'BPOP', 'BPOPN', 'BPTH', 'BRKL', 'BRLI', 'BRLIR', 'BRLIW', 'BROGW', 'BRPAR', 'BRPAU', 'BRPAW', 'BSCU', 'BSGM', 'BSJS', 'BSMU', 'BSQR', 'BSRR', 'BSY', 'BTAQ', 'BTAQU', 'BTAQW', 'BTWNU', 'BUSE', 'BWEN', 'BWFG', 'CALM', 'CAPAU', 'CAPR', 'CARE', 'CARV', 'CASH', 'CASS', 'CATB', 'CBIO', 'CBLI', 'CBRL', 'CCB', 'CCCC', 'CCNC', 'CCNEP', 'CCOI', 'CD', 'CDAK', 'CDMOP', 'CDXC', 'CDZI', 'CECE', 'CELH', 'CEMI', 'CETX', 'CETXP', 'CETXW', 'CFFAW', 'CFII', 'CFIIU', 'CFIIW', 'CFRX', 'CGIX', 'CGROW', 'CHCI', 'CHEK', 'CHEKZ', 'CHFS', 'CHNGU', 'CHNR', 'CHPMW', 'CHRW', 'CIDM', 'CIH', 'CIICW', 'CJJD', 'CLAR', 'CLBS', 'CLCT', 'CLDX', 'CLFD', 'CLGN', 'CLRB', 'CLRBZ', 'CLRO', 'CLSK', 'CLSN', 'CLWT', 'CMCSA', 'CMCT', 'CMCTP', 'CMFNL', 'CMLFU', 'CMPI', 'CMPS', 'CMTL', 'CNET', 'CNFRL', 'CNOB', 'CNSL', 'CNTY', 'COCP', 'CODA', 'COGT', 'COWN', 'COWNL', 'COWNZ', 'CPAAW', 'CPAH', 'CPLP', 'CPST', 'CPTAG', 'CPTAL', 'CREG', 'CREX', 'CREXW', 'CRIS', 'CRSAW', 'CRTD', 'CRTDW', 'CSBR', 'CSCW', 'CSSEN', 'CSWCL', 'CTIB', 'CTIC', 'CTSO', 'CTXR', 'CTXRW', 'CURI', 'CURIW', 'CUTR', 'CWCO', 'CYAN', 'CYCC', 'CYCCP', 'CYRN', 'CYRX', 'CYTK', 'DCTH', 'DENN', 'DFFN', 'DFHT', 'DFHTW', 'DFPHW', 'DGICB', 'DGLY', 'DHCNI', 'DHCNL', 'DHIL', 'DLPNW', 'DMAC', 'DPHCW', 'DRAD', 'DRADP', 'DRIO', 'DRIOW', 'DSKEW', 'DTSS', 'DUOT', 'DVAX', 'DVY', 'DXLG', 'DXPE', 'DYN', 'DYNT', 'DZSI', 'EAR', 'EARS', 'EAST', 'EBAYL', 'EBC', 'EBIX', 'ECOL', 'ECOLW', 'EDTK', 'EFOI', 'EFSC', 'EGAN', 'EGLE', 'EKSO', 'ELTK', 'EMKR', 'ENOB', 'ENTXW', 'EPIX', 'EPSN', 'EQOS', 'EQOSW', 'ERES', 'ERESW', 'ERIC', 'ESEA', 'ESSCR', 'ESSCW', 'ETAC', 'ETACW', 'EVK', 'EVOL', 'EXAS', 'EXFO', 'EXPCW', 'EXPE', 'EYEG', 'EYES', 'EYESW', 'FANH', 'FATBP', 'FATBW', 'FBIO', 'FCEL', 'FCFS', 'FDBC', 'FDUSG', 'FDUSL', 'FDUSZ', 'FENC', 'FFHL', 'FGBI', 'FIII', 'FIIIW', 'FISI', 'FLMNW', 'FLNT', 'FLUX', 'FNHC', 'FONR', 'FORD', 'FOSL', 'FPAY', 'FRAN', 'FRBK', 'FREEW', 'FRGAP', 'FRHC', 'FROG', 'FSDC', 'FSRVW', 'FSV', 'FTIVU', 'FTOC', 'FTOCW', 'FUND', 'FVAM', 'FVCB', 'FVE', 'FWP', 'GABC', 'GAIA', 'GAINM', 'GALT', 'GBCI', 'GBLI', 'GBLIL', 'GDYNW', 'GECCL', 'GECCM', 'GECCN', 'GENE', 'GEVO', 'GFNSL', 'GHIVW', 'GIGM', 'GILT', 'GLADD', 'GLADL', 'GLBS', 'GLDD', 'GLG', 'GLSI', 'GMBL', 'GMBLW', 'GMHIW', 'GNCA', 'GNRSW', 'GNSS', 'GNUS', 'GOGL', 'GOODN', 'GOVX', 'GOVXW', 'GP', 'GPOR', 'GRAY', 'GRBK', 'GRCY', 'GRCYU', 'GRCYW', 'GRFS', 'GRMN', 'GRNVR', 'GRNVW', 'GRPN', 'GRSV', 'GRSVW', 'GRVY', 'GSMGW', 'GTIM', 'GURE', 'GXGXW', 'HA', 'HAFC', 'HALL', 'HCAC', 'HCACW', 'HCAPZ', 'HCCHR', 'HCCHW', 'HCCOW', 'HCDI', 'HCKT', 'HEAR', 'HEC', 'HECCW', 'HELE', 'HEPA', 'HGBL', 'HGSH', 'HIBB', 'HJLIW', 'HNRG', 'HOFVW', 'HOL', 'HOLUU', 'HOLUW', 'HOPE', 'HOVNP', 'HPK', 'HPKEW', 'HQI', 'HROW', 'HRTX', 'HSDT', 'HSKA', 'HSON', 'HTBX', 'HTHT', 'HTLFP', 'HUGE', 'HUSN', 'HWBK', 'HWCPL', 'HWCPZ', 'HWKN', 'HX', 'HYACW', 'HYMCZ', 'HZNP', 'IAC', 'IART', 'IBBJ', 'IBCP', 'ICAD', 'ICCC', 'ICMB', 'ICON', 'IDCC', 'IDEX', 'IDN', 'IDRA', 'IDXG', 'IEAWW', 'IEC', 'IEP', 'IGACU', 'IGICW', 'IIIN', 'IKNX', 'IMACW', 'IMBI', 'IMKTA', 'IMNM', 'IMOS', 'IMRN', 'IMRNW', 'IMTXW', 'INAQU', 'INBKL', 'INBKZ', 'INBX', 'INO', 'INOD', 'INPX', 'INSM', 'INTZ', 'INVE', 'IOVA', 'IPDN', 'IPWR', 'IRCP', 'ISRG', 'ITACU', 'ITI', 'IVA', 'IZEA', 'JACK', 'JAGX', 'JAKK', 'JAMF', 'JAN', 'JAZZ', 'JCOM', 'JMPNL', 'JMPNZ', 'JRJC', 'JSM', 'KBLMR', 'KBLMU', 'KBLMW', 'KBNT', 'KBNTW', 'KBSF', 'KCAPL', 'KDNY', 'KELYA', 'KERNW', 'KINS', 'KLXE', 'KOR', 'KRBP', 'KRON', 'KSMT', 'KSMTU', 'KSMTW', 'KTOS', 'KTOV', 'KTOVW', 'LACQU', 'LACQW', 'LAMR', 'LARK', 'LATNW', 'LCAHW', 'LCAP', 'LCAPU', 'LCAPW', 'LCUT', 'LCYAU', 'LECO', 'LEDS', 'LEGR', 'LFACW', 'LFVN', 'LGHLW', 'LGND', 'LIFE', 'LIQT', 'LIVE', 'LIVKW', 'LJPC', 'LLIT', 'LMFA', 'LMFAW', 'LMRKN', 'LMRKP', 'LNSR', 'LOACR', 'LOACU', 'LOACW', 'LOAN', 'LOGI', 'LOOP', 'LPTH', 'LSACW', 'LTBR', 'LTRX', 'LUNG', 'LXEH', 'LXRX', 'MAACU', 'MACK', 'MARA', 'MARK', 'MBOT', 'MCAC', 'MCACR', 'MCEP', 'MCFT', 'MCMJW', 'MDCA', 'MDGS', 'MDGSW', 'MDJH', 'MDLZ', 'MDNA', 'MDRRP', 'MEDS', 'MEIP', 'MERC', 'METXW', 'MFH', 'MFINL', 'MGI', 'MGPI', 'MICT', 'MINDP', 'MKGI', 'MLAB', 'MLAC', 'MLACW', 'MNCLW', 'MNKD', 'MNOV', 'MNSB', 'MNSBP', 'MNST', 'MOBL', 'MOFG', 'MOGO', 'MOSY', 'MOTNU', 'MOXC', 'MRCCL', 'MRIN', 'MRKR', 'MRNS', 'MSON', 'MSTR', 'MTBCP', 'MTCH', 'MTCR', 'MTEX', 'MTP', 'MTSL', 'MVIS', 'MYOS', 'MYSZ', 'MYT', 'NAII', 'NAKD', 'NATH', 'NBACR', 'NBACW', 'NBEV', 'NCTY', 'NDRAW', 'NEO', 'NEON', 'NEPH', 'NEPT', 'NESRW', 'NETE', 'NEWT', 'NEWTI', 'NEWTL', 'NFINW', 'NGACU', 'NGHCZ', 'NHIC', 'NHICW', 'NHLD', 'NHLDW', 'NHTC', 'NKTR', 'NLTX', 'NMFCL', 'NMMCU', 'NMTR', 'NNBR', 'NNDM', 'NNOX', 'NOVSW', 'NOVT', 'NPAWW', 'NTIC', 'NTRP', 'NTWK', 'NURO', 'NUZE', 'NVAX', 'NVCN', 'NVEC', 'NVFY', 'NVIV', 'NVUS', 'NWGI', 'NWL', 'NXTD', 'NYMT', 'OBAS', 'OBLN', 'OCC', 'OCFC', 'OCSI', 'OCSL', 'ODP', 'OEG', 'OFSSG', 'OFSSI', 'OFSSL', 'OFSSZ', 'OGI', 'OLB', 'OM', 'OMEX', 'ONCR', 'ONCS', 'ONCY', 'ONTX', 'ONTXW', 'ONVO', 'OPBK', 'OPCH', 'OPESW', 'OPGN', 'OPHC', 'OPI', 'OPINI', 'OPINL', 'OPNT', 'OPRX', 'OPT', 'OPTT', 'ORGS', 'ORMP', 'ORSNR', 'ORSNW', 'OSN', 'OSUR', 'OTLK', 'OTLKW', 'OTRK', 'OTRKP', 'OXBRW', 'OXLCM', 'OXLCO', 'OXSQL', 'OXSQZ', 'OZK', 'PACW', 'PAEWW', 'PAICU', 'PANL', 'PATI', 'PAVMW', 'PAVMZ', 'PAYS', 'PCH', 'PCOM', 'PCSA', 'PCVX', 'PCYG', 'PCYO', 'PDEX', 'PEBK', 'PEIX', 'PERI', 'PESI', 'PFBC', 'PFC', 'PFIN', 'PFSW', 'PGEN', 'PHIO', 'PHIOW', 'PHUNW', 'PICO', 'PIHPP', 'PIXY', 'PLUG', 'PLW', 'PMD', 'PNBK', 'PNFPP', 'PNNTG', 'PNRG', 'POAI', 'PPBI', 'PPD', 'PPIH', 'PPSI', 'PRAX', 'PRDO', 'PRFX', 'PRGX', 'PRLD', 'PROF', 'PRPLW', 'PRPO', 'PSAC', 'PSACW', 'PSHG', 'PSTI', 'PSTV', 'PTACW', 'PTE', 'PTEN', 'PTMN', 'PTRS', 'PTVCA', 'PTVCB', 'PTVE', 'PULM', 'PXLW', 'PXSAP', 'PXSAW', 'QDEL', 'QELLU', 'QH', 'QMCO', 'QQQJ', 'QQQM', 'QQQX', 'QRHC', 'QUIK', 'RADA', 'RADI', 'RAND', 'RAVE', 'RBCN', 'RBNC', 'RCHGU', 'RCM', 'RCMT', 'RCON', 'RDCM', 'RDI', 'RDIB', 'RDNT', 'REKR', 'RELV', 'REXN', 'RFIL', 'RGLS', 'RIBT', 'RIGL', 'RILYG', 'RILYH', 'RILYI', 'RILYL', 'RILYM', 'RILYN', 'RILYO', 'RILYP', 'RILYZ', 'RIOT', 'RKDA', 'RLMD', 'RMBL', 'RMCF', 'RNST', 'RNWK', 'ROCH', 'ROCHW', 'ROIC', 'RSSS', 'RTRX', 'RUSHB', 'RWLK', 'RYAAY', 'SAII', 'SAIIW', 'SAMAW', 'SANM', 'SBCF', 'SBFG', 'SBLK', 'SBLKZ', 'SCKT', 'SCYX', 'SEED', 'SENEB', 'SESN', 'SFET', 'SFST', 'SFT', 'SFTTW', 'SGA', 'SGBX', 'SGLB', 'SGLBW', 'SGMS', 'SGOC', 'SGRP', 'SHIP', 'SHIPW', 'SHIPZ', 'SHSP', 'SIEB', 'SIFY', 'SINO', 'SINT', 'SIVBP', 'SJ', 'SLCT', 'SLGG', 'SLN', 'SLNO', 'SLS', 'SMBK', 'SMIT', 'SMMCW', 'SMMF', 'SMMT', 'SMSI', 'SMTX', 'SNBP', 'SNBR', 'SNCA', 'SNES', 'SNEX', 'SNGX', 'SNGXW', 'SNOA', 'SNSS', 'SOHO', 'SOLO', 'SOLOW', 'SPCB', 'SPI', 'SPKEP', 'SPPI', 'SPRB', 'SPRT', 'SPTN', 'SQBG', 'SQFT', 'SRACW', 'SRGA', 'SRNE', 'SRPT', 'SRRA', 'SRTS', 'SSB', 'SSKN', 'SSNT', 'SSP', 'SSPKW', 'SSSS', 'STAA', 'STAF', 'STCN', 'STEP', 'STKL', 'STKS', 'STMP', 'STRL', 'STRM', 'STRS', 'STTK', 'STWOU', 'STX', 'SUMO', 'SUMR', 'SUNW', 'SURF', 'SVACU', 'SVC', 'SWBI', 'SWKH', 'SYBT', 'SYNH', 'SYPR', 'SYTA', 'SYTAW', 'TA', 'TANNI', 'TANNL', 'TANNZ', 'TAOP', 'TARA', 'TARS', 'TATT', 'TBK', 'TBLT', 'TBLTW', 'TCBIL', 'TCFCP', 'TCOM', 'TCON', 'TCX', 'TDACW', 'TENX', 'TEUM', 'TGA', 'TGLS', 'TGTX', 'THBRW', 'THCAW', 'THCBW', 'THMO', 'THRM', 'THRY', 'THWWW', 'TIGO', 'TILE', 'TIPT', 'TLGT', 'TLND', 'TMDI', 'TMPMU', 'TMTSU', 'TNDM', 'TNXP', 'TOMZ', 'TOPS', 'TOTAR', 'TOTAW', 'TPCO', 'TRCH', 'TRIB', 'TRIL', 'TRMD', 'TRMK', 'TSEM', 'TSHA', 'TSRI', 'TTCF', 'TTCFW', 'TTEC', 'TTNP', 'TURN', 'TVTY', 'TWCTU', 'TWNK', 'TWNKW', 'TZACW', 'TZOO', 'UAL', 'UCBI', 'UEPS', 'UFCS', 'UMPQ', 'UNIT', 'UONE', 'UONEK', 'USAU', 'USEG', 'USIO', 'USLM', 'USWSW', 'UTSI', 'VACQU', 'VBFC', 'VBIV', 'VCEL', 'VERB', 'VERBW', 'VERU', 'VIAC', 'VIACA', 'VIAV', 'VIHAU', 'VISL', 'VIVE', 'VJET', 'VKTXW', 'VLDR', 'VLDRW', 'VLGEA', 'VMAC', 'VMACU', 'VMACW', 'VOD', 'VOXX', 'VRME', 'VRMEW', 'VSPRU', 'VTGN', 'VTSI', 'VUZI', 'VYNE', 'WABC', 'WEN', 'WETF', 'WHFBZ', 'WHLM', 'WHLR', 'WINA', 'WINT', 'WISA', 'WKEY', 'WKHS', 'WPRT', 'WSBF', 'WSC', 'WSTG', 'WSTL', 'WTER', 'WTREP', 'WVVIP', 'WW', 'WWR', 'XAIR', 'XBIO', 'XBIOW', 'XEL', 'XELB', 'XOMA', 'XPER', 'XRAY', 'XSPA', 'XTLB', 'YGYI', 'YGYIP', 'YRCW', 'YTEN', 'YTRA', 'YVR', 'ZAGG', 'ZAZZT', 'ZBZZT', 'ZCZZT', 'ZGNX', 'ZGYHR', 'ZGYHU', 'ZGYHW', 'ZIONL', 'ZIOP', 'ZIXI', 'ZJZZT', 'ZSAN', 'ZVO', 'ZVZZC', 'ZVZZT', 'ZWZZT', 'ZXYZ.A', 'ZXZZT', 'ZYXI']
other_invalid = ['AAA', 'AAN', 'AAU', 'AB', 'ABC', 'ABR$A', 'ABR$B', 'ABR$C', 'ACB', 'ACN', 'ACND', 'ACND.U', 'ACND.W', 'ADFI', 'AE', 'AEB', 'AEFC', 'AEL$A', 'AEL$B', 'AEO', 'AFC', 'AFGB', 'AFGC', 'AFGD', 'AFGE', 'AFGH', 'AG', 'AGM$C', 'AGM$D', 'AGM$E', 'AGM$F', 'AGM.A', 'AGO$B', 'AGO$E', 'AGO$F', 'AHH$A', 'AHL$C', 'AHL$D', 'AHL$E', 'AHT', 'AHT$D', 'AHT$F', 'AHT$G', 'AHT$H', 'AHT$I', 'AI', 'AI$B', 'AI$C', 'AIC', 'AIF', 'AIG', 'AIG$A', 'AIG.W', 'AIRI', 'AIV', 'AIW', 'AJXA', 'AKO.A', 'AKO.B', 'AL$A', 'ALE', 'ALFA', 'ALIN$A', 'ALIN$B', 'ALIN$E', 'ALL$B', 'ALL$G', 'ALL$H', 'ALL$I', 'ALLY$A', 'ALP$Q', 'ALTG.W', 'ALUS.U', 'ALUS.W', 'AMBC.W', 'AMBO', 'AMER', 'AMH$D', 'AMH$E', 'AMH$F', 'AMH$G', 'AMH$H', 'AMNA', 'AMND', 'AMWL', 'ANEW', 'ANH$A', 'ANH$B', 'ANH$C', 'ANTM', 'AONE', 'AONE.U', 'AONE.W', 'AP.W', 'APH', 'APO', 'APO$A', 'APO$B', 'APRN', 'APSG.U', 'APTV', 'APTV$A', 'AQNA', 'AQNB', 'ARCH', 'ARES$A', 'ARGD', 'ARGO$A', 'ARR', 'ARR$C', 'ASA', 'ASAN', 'ASAQ', 'ASAQ.U', 'ASAQ.W', 'ASB$C', 'ASB$D', 'ASB$E', 'ASB$F', 'ASG', 'ASGI', 'ASM', 'ASPL.U', 'AT', 'ATCO', 'ATCO$D', 'ATCO$E', 'ATCO$G', 'ATCO$H', 'ATCO$I', 'ATEST', 'ATEST.A', 'ATEST.B', 'ATEST.C', 'ATH$A', 'ATH$B', 'ATH$C', 'ATI', 'ATNM', 'ATTO', 'ATV', 'AU', 'AUGZ', 'AVAN.U', 'AVB', 'AVIG', 'AVSF', 'AVTR$A', 'AVUV', 'AXO', 'AXS$E', 'BAB', 'BAC$A', 'BAC$B', 'BAC$C', 'BAC$E', 'BAC$K', 'BAC$L', 'BAC$M', 'BAC$N', 'BAM', 'BANC$D', 'BANC$E', 'BBD', 'BBL', 'BBSA', 'BBVA', 'BC$A', 'BC$B', 'BC$C', 'BCAT', 'BCE', 'BCV$A', 'BDN', 'BDXB', 'BEKE', 'BEP$A', 'BF.A', 'BF.B', 'BFS$D', 'BFS$E', 'BFT', 'BFT.U', 'BFT.W', 'BGH', 'BGI', 'BH.A', 'BHR', 'BHR$B', 'BHR$D', 'BIO.B', 'BIP$A', 'BK', 'BK$C', 'BML$G', 'BML$H', 'BML$J', 'BML$L', 'BMRG.U', 'BMRG.W', 'BMY', 'BMY.R', 'BNKZ', 'BNL', 'BOE', 'BOH', 'BORR', 'BQ', 'BRG$A', 'BRG$C', 'BRG$D', 'BRK.A', 'BRK.B', 'BRMK.W', 'BSA', 'BSAC', 'BSN.U', 'BSX$A', 'BTO', 'BTT', 'BVH', 'BW', 'BWL.A', 'BXC', 'BXP$B', 'BXS$A', 'BZH', 'C', 'C$J', 'C$K', 'C$N', 'C$S', 'CACI', 'CAH', 'CAI$A', 'CAI$B', 'CAL', 'CANF', 'CATO', 'CB', 'CBB', 'CBB$B', 'CBL$D', 'CBL$E', 'CBO', 'CBRE', 'CBX', 'CCAC.U', 'CCAC.W', 'CCIV', 'CCIV.U', 'CCIV.W', 'CCK', 'CCL', 'CCON', 'CCR', 'CCRV', 'CCX.U', 'CCX.W', 'CCZ', 'CDE', 'CDOR', 'CDR', 'CDR$B', 'CDR$C', 'CEF', 'CEI', 'CELG.R', 'CEM', 'CEQP', 'CEQP$', 'CFG$D', 'CFG$E', 'CFXA', 'CGA', 'CHAQ.U', 'CHAQ.W', 'CHE', 'CHIC', 'CHMI$A', 'CHMI$B', 'CHT', 'CIB', 'CIEN', 'CIF', 'CIG.C', 'CIK', 'CIM', 'CIM$A', 'CIM$B', 'CIM$C', 'CIM$D', 'CIO$A', 'CIT$B', 'CLA', 'CLA.U', 'CLA.W', 'CLF', 'CLI', 'CLII.U', 'CLM', 'CLNY', 'CLNY$G', 'CLNY$H', 'CLNY$I', 'CLNY$J', 'CMCL', 'CMO', 'CMO$E', 'CMRE$B', 'CMRE$C', 'CMRE$D', 'CMRE$E', 'CMS$B', 'CMSA', 'CMSC', 'CMSD', 'CMU', 'CNP$B', 'CO', 'CODI$A', 'CODI$B', 'CODI$C', 'COF$F', 'COF$G', 'COF$H', 'COF$I', 'COF$J', 'COF$K', 'COHN', 'COO', 'CORR', 'CORR$A', 'CPAC', 'CPE', 'CPF', 'CPSR', 'CPSR.U', 'CPSR.W', 'CRD.A', 'CRD.B', 'CRF', 'CRHC.U', 'CRM', 'CRMD', 'CTA$A', 'CTA$B', 'CTAA', 'CTBB', 'CTDD', 'CTEST', 'CTEST.E', 'CTEST.G', 'CTEST.L', 'CTEST.O', 'CTEST.S', 'CTEST.V', 'CTO', 'CTR', 'CTY', 'CTZ', 'CUBB', 'CUBI$C', 'CUBI$D', 'CUBI$E', 'CUBI$F', 'CUZ', 'CVM', 'CVU', 'CVX', 'CWEN.A', 'CXE', 'CXH', 'DAC', 'DAO', 'DBI', 'DCP$B', 'DCP$C', 'DCUE', 'DD', 'DDD', 'DDS', 'DEH', 'DEH.U', 'DEH.W', 'DEN', 'DEO', 'DESP', 'DFNS.U', 'DFNS.W', 'DGNR', 'DGNR.U', 'DGNR.W', 'DHR', 'DHR$A', 'DHR$B', 'DHT', 'DIT', 'DJUL', 'DK', 'DLNG$A', 'DLNG$B', 'DLR$C', 'DLR$J', 'DLR$K', 'DLR$L', 'DLY', 'DMS', 'DMS.W', 'DMYD', 'DMYD.U', 'DMYD.W', 'DMYT.U', 'DMYT.W', 'DNK', 'DPW', 'DQ', 'DRD', 'DRE', 'DRH$A', 'DRUA', 'DS$B', 'DS$C', 'DS$D', 'DSS', 'DSU', 'DSX$B', 'DTB', 'DTJ', 'DTLA$', 'DTP', 'DTQ', 'DTW', 'DTY', 'DUAL', 'DUK', 'DUK$A', 'DUKB', 'DUKH', 'DVD', 'DVN', 'DWMF', 'DX', 'DX$B', 'DX$C', 'DXF', 'DYFN', 'EAD', 'EAI', 'EBR.B', 'ECCX', 'ECCY', 'ECF$A', 'EEX', 'EFC$A', 'EGHT', 'EGO', 'EGP', 'EGY', 'EHI', 'ELA', 'ELAT', 'ELC', 'ELJ', 'ELLO', 'ELU', 'EMAN', 'EMD', 'EMMF', 'EMO', 'EMP', 'EMPW.U', 'ENBA', 'ENJ', 'ENO', 'ENPC.U', 'ENR$A', 'ENSV', 'EOD', 'EP$C', 'EPAC', 'EPR$C', 'EPR$E', 'EPR$G', 'EQC', 'EQC$D', 'EQD.U', 'EQH', 'EQH$A', 'EQX', 'ERC', 'ERH', 'ERJ', 'ESE', 'ESTE', 'ETI$', 'ETN', 'ETP$C', 'ETP$D', 'ETP$E', 'ETR', 'EVBN', 'EVI', 'EWH', 'EXN', 'EXP', 'EZT', 'F', 'F$B', 'F$C', 'FAII', 'FAII.U', 'FAII.W', 'FBC', 'FBP', 'FCRW', 'FCRZ', 'FDX', 'FEAC.U', 'FEAC.W', 'FEDX', 'FEN', 'FFC', 'FGNA.U', 'FHN$A', 'FHN$B', 'FHN$C', 'FHN$D', 'FHN$E', 'FLNG', 'FLS', 'FLY', 'FMAC.U', 'FMC', 'FMO', 'FNB$E', 'FPI$B', 'FRC$G', 'FRC$H', 'FRC$I', 'FRC$J', 'FRC$K', 'FRO', 'FRT$C', 'FSK', 'FST', 'FST.U', 'FST.W', 'FTAI$A', 'FTAI$B', 'FTHY', 'FTSI', 'FTV$A', 'FUBO', 'FURY', 'FUSE', 'FUSE.U', 'FUSE.W', 'FVAC.U', 'FVAC.W', 'FXI', 'GAB$G', 'GAB$H', 'GAB$J', 'GAB$K', 'GAM$B', 'GAU', 'GB.W', 'GBLO', 'GBR', 'GDL$C', 'GDV$G', 'GDV$H', 'GEF.B', 'GEO', 'GER', 'GFLU', 'GFY', 'GGN', 'GGN$B', 'GGO$A', 'GGT$E', 'GGT$G', 'GGZ$A', 'GIK', 'GIK.U', 'GIK.W', 'GIX.R', 'GIX.U', 'GIX.W', 'GJH', 'GJO', 'GJP', 'GJR', 'GJS', 'GJT', 'GL$C', 'GLDG', 'GLDM', 'GLEO.U', 'GLEO.W', 'GLOG$A', 'GLOP$A', 'GLOP$B', 'GLOP$C', 'GLP$A', 'GLT', 'GLU$A', 'GLU$B', 'GME', 'GMED', 'GMRE', 'GMRE$A', 'GMTA', 'GNE$A', 'GNK', 'GNL', 'GNL$A', 'GNL$B', 'GNT', 'GNT$A', 'GOAC', 'GOAC.U', 'GOAC.W', 'GOED', 'GOF', 'GOL', 'GOLD', 'GPJA', 'GPK', 'GPL', 'GRP.U', 'GRX$B', 'GS$A', 'GS$C', 'GS$D', 'GS$J', 'GS$K', 'GS$N', 'GSAH', 'GSAH.U', 'GSAH.W', 'GSK', 'GSL', 'GSL$B', 'GSLD', 'GSS', 'GSX', 'GTN', 'GTN.A', 'GTY', 'GUT$A', 'GUT$C', 'GYC', 'HCFT', 'HCXY', 'HCXZ', 'HE', 'HEI', 'HEI.A', 'HES', 'HEXO', 'HFC', 'HFRO$A', 'HGH', 'HIG$G', 'HIO', 'HIX', 'HL$B', 'HLM$', 'HLT', 'HLX', 'HMLP$A', 'HMY', 'HNGR', 'HON', 'HOV', 'HPX', 'HPX.U', 'HPX.W', 'HQH', 'HQL', 'HSBC', 'HSBC$A', 'HST', 'HT', 'HT$C', 'HT$D', 'HT$E', 'HTA', 'HTFA', 'HTH', 'HTZ', 'HUSA', 'HVT.A', 'HWM', 'HWM$', 'HXL', 'HYB', 'HYLN', 'HYLN.W', 'HZAC', 'HZAC.U', 'HZAC.W', 'IACA.U', 'IAE', 'IBIO', 'IBO', 'ICD', 'ICL', 'IDE', 'IDT', 'IFFT', 'IFS', 'IGA', 'IGC', 'IGD', 'IGZ', 'IH', 'IHC', 'IHD', 'IHG', 'IID', 'IIPR$A', 'IMH', 'IMPX.U', 'INFU', 'INGR', 'INN$D', 'INN$E', 'INS', 'INSI', 'INSW$A', 'INT', 'INUV', 'IO', 'IOR', 'IPB', 'IPI', 'IPOB.U', 'IPOB.W', 'IPOC', 'IPOC.U', 'IPOC.W', 'IPOD.U', 'IPOE.U', 'IPOF.U', 'IPV', 'IPV.U', 'IPV.W', 'IQI', 'IR', 'IRET', 'IRET$C', 'IRR', 'ISDR', 'ISR', 'IT', 'ITCB', 'ITGR', 'ITP', 'ITRG', 'ITUB', 'IVR$A', 'IVR$B', 'IVR$C', 'JBK', 'JCAP$B', 'JE', 'JHX', 'JIH.U', 'JIH.W', 'JMIA', 'JMM', 'JOF', 'JPM', 'JPM$C', 'JPM$D', 'JPM$G', 'JPM$H', 'JPM$J', 'JPNL', 'JW.A', 'JW.B', 'JWS', 'JWS.U', 'JWS.W', 'KBH', 'KCAC', 'KCAC.U', 'KCAC.W', 'KESG', 'KEY$I', 'KEY$J', 'KEY$K', 'KF', 'KFS', 'KGC', 'KIM$L', 'KIM$M', 'KIQ', 'KKR$A', 'KKR$B', 'KKR$C', 'KLR.W', 'KRBN', 'KRG', 'KSM', 'KSU', 'KSU$', 'KTH', 'KTN', 'KWT', 'LAC', 'LC', 'LCG', 'LCII', 'LCTX', 'LEAF', 'LEAP.U', 'LEN.B', 'LGC.U', 'LGC.W', 'LGF.A', 'LGF.B', 'LGVW', 'LGVW.U', 'LGVW.W', 'LH', 'LHX', 'LIV', 'LL', 'LNG', 'LOAK.U', 'LOAK.W', 'LODE', 'LPI', 'LSF', 'LUMN', 'LXP', 'LXP$C', 'LYV', 'M', 'MAA$I', 'MATX', 'MCC', 'MCF', 'MCI', 'MCK', 'MCN', 'MCO', 'MCV', 'MCX', 'MDLQ', 'MDLX', 'MED', 'MER$K', 'MET$A', 'MET$E', 'MET$F', 'MFA', 'MFA$B', 'MFA$C', 'MFAC.U', 'MFAC.W', 'MFGP', 'MFO', 'MGR', 'MGRB', 'MH$A', 'MH$C', 'MH$D', 'MHF', 'MHLA', 'MHNC', 'MITT$A', 'MITT$B', 'MITT$C', 'MKC.V', 'MLPY', 'MLR', 'MLSS', 'MMLG', 'MMM', 'MMU', 'MMX', 'MNP', 'MNR$C', 'MNSO', 'MOG.A', 'MOG.B', 'MPLN', 'MPLN.W', 'MPV', 'MR', 'MRK', 'MS', 'MS$A', 'MS$E', 'MS$F', 'MS$I', 'MS$K', 'MS$L', 'MSI', 'MSOS', 'MSTB', 'MT', 'MTA', 'MTB', 'MTCN', 'MTH', 'MTL', 'MTL$', 'MTN', 'MTOR', 'MTRN', 'MTW', 'MUFG', 'MVC', 'MVCD', 'MYO', 'NAV', 'NAV$D', 'NAVB', 'NBR', 'NBR$A', 'NBY', 'NCV', 'NCV$A', 'NCZ', 'NCZ$A', 'NDMO', 'NDP', 'NEE', 'NEE$I', 'NEE$J', 'NEE$K', 'NEE$N', 'NEE$O', 'NEE$P', 'NEE$Q', 'NEU', 'NEXA', 'NFH.W', 'NGA', 'NGA.U', 'NGA.W', 'NGG', 'NGL$B', 'NGL$C', 'NGLS$A', 'NHF', 'NHS', 'NI', 'NI$B', 'NIE', 'NIQ', 'NL', 'NLS', 'NLY$D', 'NLY$F', 'NLY$G', 'NLY$I', 'NM', 'NM$G', 'NM$H', 'NMK$B', 'NMK$C', 'NMM', 'NNA', 'NNN', 'NNN$F', 'NNVC', 'NOG', 'NR', 'NREF$A', 'NRP', 'NRUC', 'NRZ', 'NRZ$A', 'NRZ$B', 'NRZ$C', 'NS$A', 'NS$B', 'NS$C', 'NSA$A', 'NSCO.W', 'NSH.U', 'NSP', 'NSPR', 'NSPR.B', 'NSPR.W', 'NSS', 'NTB', 'NTEST', 'NTEST.A', 'NTEST.B', 'NTEST.C', 'NTG', 'NTN', 'NTP', 'NTST', 'NTZ', 'NVGS', 'NYC', 'NYCB$A', 'NYCB$U', 'OAC.U', 'OAC.W', 'OACB.U', 'OAK$A', 'OAK$B', 'OBLG', 'OCFT', 'OCN', 'OFC', 'OFG$A', 'OFG$B', 'OFG$D', 'OGEN', 'OIBR.C', 'OKE', 'OMC', 'OMI', 'OPY', 'ORAN', 'OSB', 'OSG', 'OUT', 'OVV', 'OXY.W', 'PACD', 'PACE.U', 'PAGP', 'PAI', 'PANA', 'PANA.U', 'PANA.W', 'PARR', 'PBB', 'PBC', 'PBI$B', 'PBR.A', 'PBY', 'PCG$A', 'PCG$B', 'PCG$C', 'PCG$D', 'PCG$E', 'PCG$G', 'PCG$H', 'PCG$I', 'PCGU', 'PCPL.U', 'PCPL.W', 'PCY', 'PDAC.U', 'PDI', 'PEAK', 'PEB$C', 'PEB$D', 'PEB$E', 'PEB$F', 'PED', 'PEG', 'PEI$B', 'PEI$C', 'PEI$D', 'PFH', 'PHB', 'PHG', 'PHGE.U', 'PHGE.W', 'PHM', 'PIAI.U', 'PIC.U', 'PIC.W', 'PKI', 'PLAG', 'PLG', 'PLM', 'PLT', 'PLTR', 'PLX', 'PLYM$A', 'PMT$A', 'PMT$B', 'PMVC.U', 'PNC$P', 'PNR', 'PNW', 'PPL', 'PPR', 'PPX', 'PRA', 'PRE$F', 'PRE$G', 'PRE$H', 'PRE$I', 'PRIF$A', 'PRIF$B', 'PRIF$C', 'PRIF$D', 'PRIF$E', 'PRIF$F', 'PRMW', 'PRPB', 'PRPB.U', 'PRPB.W', 'PRS', 'PSA$B', 'PSA$C', 'PSA$D', 'PSA$E', 'PSA$F', 'PSA$G', 'PSA$H', 'PSA$I', 'PSA$J', 'PSA$K', 'PSA$L', 'PSA$M', 'PSA$N', 'PSB$W', 'PSB$X', 'PSB$Y', 'PSB$Z', 'PSLV', 'PSTH', 'PSTH.W', 'PTK', 'PTK.U', 'PTK.W', 'PTN', 'PUK$', 'PUK$A', 'PVI', 'PVL', 'PW', 'PW$A', 'PXD', 'PYS', 'PYT', 'PZA', 'QGEN', 'QTS$A', 'QTS$B', 'QUOT', 'QVCC', 'QVCD', 'RACE', 'RAD', 'RBAC', 'RBAC.U', 'RBAC.W', 'RCA', 'RCB', 'RCG', 'RCI', 'RCP', 'RDN', 'RDS.A', 'RDS.B', 'RE', 'REC', 'RELX', 'RENN', 'RESI', 'REV', 'REX', 'REXR$A', 'REXR$B', 'REXR$C', 'RF$A', 'RF$B', 'RF$C', 'RFP', 'RGA', 'RGI', 'RHE', 'RHE$A', 'RHI', 'RHP', 'RIO', 'RISN', 'RIV.R', 'RJF', 'RL', 'RLGT', 'RLH', 'RLJ$A', 'RMG.U', 'RMG.W', 'RMPL$', 'RNR$E', 'RNR$F', 'RPLA.U', 'RPLA.W', 'RPT', 'RPT$D', 'RRC', 'RRD', 'RSF', 'RTP.U', 'RY$T', 'RZA', 'RZB', 'SA', 'SACC', 'SAF', 'SAK', 'SALT', 'SAN', 'SAN$B', 'SAND', 'SAR', 'SB$C', 'SB$D', 'SBBA', 'SBE.U', 'SBE.W', 'SBG.U', 'SBI', 'SBSW', 'SCA', 'SCCB', 'SCCC', 'SCE$G', 'SCE$H', 'SCE$J', 'SCE$K', 'SCE$L', 'SCHW$C', 'SCHW$D', 'SCPE.U', 'SCPE.W', 'SCU', 'SCVX.U', 'SCVX.W', 'SDPI', 'SEAH.U', 'SEB', 'SEE', 'SENS', 'SEPZ', 'SF$A', 'SF$B', 'SF$C', 'SFB', 'SFE', 'SFTW.U', 'SFTW.W', 'SFUN', 'SHI', 'SHO$E', 'SHO$F', 'SHOP', 'SIG', 'SII', 'SITC', 'SITC$A', 'SITC$K', 'SJIJ', 'SJIU', 'SJM', 'SKM', 'SLG$I', 'SLQT', 'SMFG', 'SMM', 'SMTS', 'SNDR', 'SNMP', 'SNN', 'SNOW', 'SNPR.U', 'SNV', 'SNV$D', 'SNV$E', 'SOAC.U', 'SOAC.W', 'SOJA', 'SOJB', 'SOJC', 'SOJD', 'SOJE', 'SOL', 'SOLN', 'SOS', 'SPAK', 'SPAQ.U', 'SPAQ.W', 'SPE$B', 'SPG', 'SPG$J', 'SPGI', 'SPLP$A', 'SQNS', 'SR', 'SR$A', 'SRC', 'SRC$A', 'SRE$A', 'SRE$B', 'SREA', 'SRG$A', 'SRL', 'SRV', 'SSL', 'SSY', 'STAG$C', 'STAR', 'STAR$D', 'STAR$G', 'STAR$I', 'STE', 'STL', 'STL$A', 'STM', 'STN', 'STNG', 'STON', 'STPK', 'STPK.U', 'STPK.W', 'STT', 'STT$D', 'STT$G', 'STXS', 'STZ', 'STZ.B', 'SUZ', 'SVM', 'SWT', 'SYF$A', 'SYN', 'SYX', 'SZC', 'T$A', 'T$C', 'TAK', 'TALO.W', 'TAP', 'TAP.A', 'TAT', 'TBB', 'TBC', 'TBI', 'TBJL', 'TCI', 'TCO$J', 'TCO$K', 'TDA', 'TDE', 'TDI', 'TDJ', 'TDS', 'TDW.A', 'TDW.B', 'TDW.W', 'TEF', 'TEL', 'TEX', 'TFC', 'TFC$F', 'TFC$G', 'TFC$H', 'TFC$I', 'TFC$O', 'TFC$R', 'TFJL', 'TGC', 'TGNA', 'TGP$A', 'TGP$B', 'TGT', 'THC', 'THG', 'TIMB', 'TK', 'TKAT', 'TKC', 'TLI', 'TME', 'TMHC', 'TMP', 'TMQ', 'TMX', 'TNK', 'TNP', 'TNP$C', 'TNP$D', 'TNP$E', 'TNP$F', 'TPC', 'TPGY.U', 'TPR', 'TPVY', 'TREB', 'TREB.U', 'TREB.W', 'TREC', 'TRI', 'TRNE.U', 'TRNE.W', 'TRQ', 'TRT', 'TRTN$A', 'TRTN$B', 'TRTN$C', 'TRTN$D', 'TRV', 'TRX', 'TRXC', 'TT', 'TTP', 'TU', 'TVC', 'TVE', 'TWND.U', 'TWO', 'TWO$A', 'TWO$B', 'TWO$C', 'TWO$D', 'TWO$E', 'TY$', 'TYG', 'TYL', 'U', 'UBP', 'UBP$H', 'UBP$K', 'UFI', 'UFS', 'UI', 'UIS', 'UL', 'UMC', 'UMH$B', 'UMH$C', 'UMH$D', 'UN', 'UNF', 'UNH', 'UNMA', 'USA', 'USB', 'USB$A', 'USB$H', 'USB$M', 'USB$O', 'USB$P', 'UTZ.W', 'UUU', 'UUUU', 'UUUU.W', 'UVE', 'UZA', 'UZB', 'UZC', 'UZD', 'VALE', 'VAR', 'VEDL', 'VER', 'VER$F', 'VERT.U', 'VGAC.U', 'VGR', 'VGZ', 'VHC', 'VHI', 'VIAO', 'VIV', 'VLO', 'VNCE', 'VNO', 'VNO$K', 'VNO$L', 'VNO$M', 'VNRX', 'VNT', 'VOYA', 'VOYA$B', 'VRT.W', 'VST', 'VST.A', 'VTR', 'VVI', 'VVNT', 'VVNT.W', 'VXZ', 'VYGG.U', 'VZ', 'WALA', 'WBS$F', 'WBT', 'WCC$A', 'WELL', 'WFC', 'WFC$L', 'WFC$N', 'WFC$O', 'WFC$P', 'WFC$Q', 'WFC$R', 'WFC$T', 'WFC$V', 'WFC$W', 'WFC$X', 'WFC$Y', 'WFC$Z', 'WLL', 'WM', 'WPF', 'WPF.U', 'WPF.W', 'WPG', 'WPG$H', 'WPG$I', 'WPM', 'WPP', 'WRB$B', 'WRB$C', 'WRB$D', 'WRB$E', 'WRB$F', 'WRB$G', 'WRI', 'WSO.B', 'WST', 'WTM', 'WTRG', 'WTRU', 'WTT', 'X', 'XAN$C', 'XOM', 'XPEV', 'XPL', 'XPO', 'XTNT', 'YAC', 'YAC.U', 'YAC.W', 'YALA', 'YCBD$A', 'YUM', 'ZBZX', 'ZEXIT', 'ZIEXT', 'ZOM', 'ZTEST', 'ZTO', 'ZVV', 'ZXIET']

print()
print("downloaded symbols: " + str(len(nasdaq) + len(other)))

print("nasdaq invalid: " + str(len(nasdaq_invalid)))
print("other invalid: " + str(len(other_invalid)))

available_tickers = len(nasdaq) + len(other) - len(nasdaq_invalid) - len(other_invalid)

print("theoretical available: " + str(available_tickers))

# list of all tickers
all_tickers = {*nasdaq, *other}

# remove invalid tickers
for invalids in (nasdaq_invalid, other_invalid):
    for invalid in invalids:
        if invalid in all_tickers:
            all_tickers.remove(invalid)

# list of available tickers
print(all_tickers)
print("final available: " + str(len(all_tickers)))
